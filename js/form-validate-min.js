"use strict";!function(){var e=[],t=function(e,t){this.errors=[],this.field=e,this.length=t};t.prototype={stopSubmit:function(){this.errors.length>0&&e.push("invalid")},colorizeValid:function(){this.field.classList.remove("modal-feedback__invalid-field")},colorizeInvalid:function(){this.field.classList.add("modal-feedback__invalid-field")},cleanErrorMessage:function(){var e=this.field.id,t=i.querySelectorAll("#"+e+"+ p");Array.prototype.slice.call(t).forEach(function(e){e.textContent=""})},setErrorMessage:function(){this.cleanErrorMessage();var e=i.querySelector("#"+this.field.id+"+ p");if(this.errors.length>0){var t=this.errors,s=document.createDocumentFragment();t.forEach(function(e){var t=document.createElement("p");t.classList.add("modal-feedback__error"),t.innerHTML="*"+e,s.appendChild(t)}),e.appendChild(s)}},checkIfEmpty:function(){if(""===this.field.value||this.field.value.match(/^\s/))return this.errors.push("Поле не может быть пустым или начинаться с пробелов!"),!0},checkIfTooShort:function(){if(this.field.value.length<this.length)return this.errors.push("Поле не может быть короче "+this.length+" символов"),!0},checkPhonePattern:function(){if(!this.field.value.match(/((\+?7\s?\(?(9\d{2}|343)\)?)\s?\d{3}-?\s?\d{2}(-?\s?)\d{2})|((8\s?\(?(9\d{2}|343)\)?)\s?\d{3}-?\s?\d{2}(-?\s?)\d{2})/))return this.errors.push("Номер телефона должен начинаться с +79 или 89 или +7(343) или 8(343)"),!0},checkMailPattern:function(){if(!this.field.value.match(/\w+@\w+/))return this.errors.push("Адрес эл. почты должен состоять из латинских букв и символа @ образец: example@mail.ru"),!0},checkMessagePattern:function(){if(this.field.value.match(/<|>|\/|\\|<a>|<\/a>|<img>|\|/))return this.errors.push("Поле Сообщение не может содержать символы < > \\ / |, а также теги html-разметки"),!0},checkName:function(){var e=this.checkIfEmpty(this.field),t=this.checkIfTooShort(this.field,this.length);e||t?(this.setErrorMessage(),this.colorizeInvalid()):(this.colorizeValid(),this.cleanErrorMessage())},checkPhone:function(){var e=this.checkIfEmpty(this.field),t=this.checkPhonePattern(this.field),i=this.checkIfTooShort(this.field,this.length);e||t||i?(this.setErrorMessage(),this.colorizeInvalid()):(this.colorizeValid(),this.cleanErrorMessage())},checkMail:function(){var e=this.checkIfEmpty(this.field),t=this.checkMailPattern();e||t?(this.setErrorMessage(),this.colorizeInvalid()):(this.colorizeValid(),this.cleanErrorMessage())},checkMessage:function(){var e=this.checkMessagePattern(this.field),t=this.checkIfEmpty(this.field),i=this.checkIfTooShort(this.field,this.length);e||t||i?(this.setErrorMessage(),this.colorizeInvalid()):(this.colorizeValid(),this.cleanErrorMessage())}};var i=document.querySelector(".modal-feedback__form"),s=i.querySelector(".modal-feedback__form-submit"),r=(document.querySelector(".modal-feedback"),{phoneField:i.querySelector("input#feedback-tel"),messageField:i.querySelector("textarea#feedback-message"),nameField:i.querySelector("input#feedback-name"),mailField:i.querySelector("input#feedback-mail"),spamCheckField:i.querySelector("input#phone-check")});function c(){new t(r.nameField,3).checkName(),new t(r.phoneField,11).checkPhone(),new t(r.mailField).checkMail(),new t(r.messageField,15).checkMessage()}i.addEventListener("input",c),s.addEventListener("click",function(s){var c=new t(r.nameField,3);c.checkName(),c.stopSubmit();var a=new t(r.phoneField,11);a.checkPhone(),a.stopSubmit();var h=new t(r.mailField);h.checkMail(),h.stopSubmit();var l=new t(r.messageField,15);l.checkMessage(),l.stopSubmit(),0===e.length&&""===r.spamCheckField.value?(i.submit(),i.reset(),alert("Сообщение успешно отправлено")):s.preventDefault(),i.querySelector(".modal-feedback__form-close"),e=[]})}();